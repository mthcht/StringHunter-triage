"""    CertHash: "
"""    UsernameHint: "
"""   UsernameHint: "
""" $EventLogPath$EventLogName"
""" $RegValue"
""" %i in ('findstr/n .* RDPLoginFail.csv')do @if %i leq 10 (echo.%j)"
""" -FilterXPath "
""" -Name "
""" -Value "
""" -o:CSV"
""" /f"
""" /q:"
""" = $event.System.TimeCreated.SystemTime | Convert-DateTimeFormat -OutputFormat 'yyyy"
""" => "
"""$1\"
"""$EventRecordID"
"""$EventType\"
"""$IpAddress"
"""$RegPathValue"
"""$RegPath\"
"""$ServerName"
"""$UsernameHint"
"""%4"
"""%i\"
"""')]]"
""")"
"""*[EventData[(Data[@Name='IpAddress']!='"
"""*[EventData[(Data[@Name='LogonType']='10') or (Data[@Name='LogonType']='3')] and System[EventID=4625]]"
"""*[EventData[(Data[@Name='LogonType']='10')] and System[EventID=4624]]"
"""*[System[(EventID !='1024')]]"
"""*[System[(EventID !='1149')]]"
"""*[System[(EventID !='131') and (EventID !='140')]]"
"""*[System[(EventID !='21') and (EventID !='22') and (EventID !='24') and (EventID !='25')]]"
"""*[System[(EventID=131) or (EventID=140)]]"
"""*[System[(EventID=21) or (EventID=22) or (EventID=24) or (EventID=25)]]"
"""*[System[(EventID=4624)] and EventData[Data[@Name='LogonType']=10]]"
"""*[System[(EventRecordID!='"
"""*[System[EventID=1024]]"
"""*[System[EventID=1149]]"
"""*[System[EventID=4648]]"
"""+$Name+"
""",  "
""", "
""", %(EventRecordID => "
""", %(EventType => "
""", %(IpAddress => "
""", %(MaxSize => "
""", %(RegPath => "
""", %(fDenyTSConnections => "
""", @("
""", EventType => "
""", RegValue => "
""","
"""./logparser/LogParser.exe"
"""./powershell/ClearnDefaultRdp.ps1"
"""./powershell/ClearnEventRecordID.ps1"
"""./powershell/ClearnIpAddress.ps1"
"""./powershell/ClearnRegName.ps1"
"""./powershell/ClearnRegValue.ps1"
"""./powershell/ClearnTempLog.ps1"
"""./powershell/ClientActiveXCore.ps1"
"""./powershell/EventLogCredentials.ps1"
"""./powershell/EventLogFailed.ps1"
"""./powershell/EventLogSuccess.ps1"
"""./powershell/EventLogSuccessWevtutil.ps1"
"""./powershell/FileDefaultRdp.ps1"
"""./powershell/KillEvenlogService.ps1"
"""./powershell/LocalSessionManager.ps1"
"""./powershell/RdpCoreTS.ps1"
"""./powershell/RegClientHostName.ps1"
"""./powershell/RegRdcServer.ps1"
"""./powershell/RegRdpPort.ps1"
"""./powershell/RegSecMaxSize.ps1"
"""./powershell/RegfDenyTSConnections.ps1"
"""./powershell/RemoteConnectionManager.ps1"
"""./powershell/SearchAllEventLog.ps1"
""".evtx"
"""/"
"""100"
"""1000"
"""1024"
"""127.0.0.1"
"""20"
"""200"
"""50"
"""All in One : Search"
"""AllEvent"
"""Application"
"""Author: whoam1@QAX-A-TEAM"
"""CLIENTNAME"
"""Change $EventLogType EventLog MaxSize to $MaxSize M"
"""Change MaxSize (M):"
"""Change PowerShell ExecutionPolicy to RemoteSigned(.Default:Restricted)"
"""Change PowerShell ExecutionPolicy to Restricted(.Default:Restricted)"
"""Change PowerShell ExecutionPolicy to Unrestricted(.Default:Restricted)"
"""Change RDP fDenyTSConnections status to $fDenyTSConnections (0 open / 1 close)"
"""Change RDP fDenyTSConnections status"
"""Change RDP fDenyTSConnections: "
"""Change Security EventLog MaxSize"
"""Check PowerShell ExecutionPolicy(.Default:Restricted)"
"""Check Rdp Open Port"
"""CheckNetVersion for Powershell Get-WinEvent cmdlet."
"""CheckNetVersion"
"""CheckPSExecutionPolicy"
"""CheckRdpStatus"
"""Clearn $EventType Eventlog "
"""Clearn All Eventlog"
"""Clearn DefaultRdp File"
"""Clearn TempLog File"
"""Clearn"
"""ClearnAll"
"""ClearnDefaultRdp"
"""ClearnEventRecordID $EventType $EventTypeFlag $EventRecordID"
"""ClearnIpAddress $EventType $EventTypeFlag $IpAddress"
"""ClearnRegName \"
"""ClearnRegValue \"
"""ClearnTempLog"
"""ClientActiveXCore"
"""Computer"
"""DefaultRdp"
"""Delete EventLog where EventType = $EventType & EventRecordID = $EventRecordID"
"""Delete EventLog where EventType = $EventType & IpAddress = $IpAddress"
"""Delete EventLog with EventRecordID"
"""Delete EventLog with IpAddress"
"""Delete EventRecordID"
"""Delete IpAddress"
"""Delete Reg Path Value"
"""Delete Reg where RegPath = $RegPath & RegValue = $RegValue"
"""EnablePSRemoteSigned"
"""EnablePSRestricted"
"""EnablePSUnrestricted"
"""EventID"
"""EventLog Type:"
"""EventLogCredentials"
"""EventLogFailed"
"""EventLogFailedLogParser"
"""EventLogMaster Helper Info"
"""EventLogMaster"
"""EventLogSuccess"
"""EventLogSuccessWevtutil"
"""EventLogType"
"""EventRecordID"
"""EventRecordID:"
"""EventType"
"""EventlogService"
"""FailedLog Maybe more than MaxSize. Suggest Use EventLogFailedLogParser. Maybe Wait a second."
"""FileDefaultRdp"
"""GO ?"
"""Get NT event log path %SystemRoot%+filename "
"""Get RDC server:port & Credentials"
"""Get RDP Client HostName"
"""Get RDP Default.rdp File::full address)"
"""Get RDP Login Failed Event (ID=4625&Type=10/3) with LogParser. Default: LoginFailIp,Times Top line. Tips: Times < 5 Maybe administrator True SourceIp"
"""Get RDP Login Failed Event (ID=4625&Type=10/3)"
"""Get RDP Login Success Event (ID=4624&Type=10) with Wevtutil"
"""Get RDP Login Success Event (ID=4624&Type=10)"
"""Get RDP Login Success Event (ID=4648)"
"""Get RDP RemoteDesktopServices RdpCoreTS EventLog (ID=131&140)"
"""Get RDP TerminalServices ClientActiveXCore EventLog (ID=1024)"
"""Get RDP TerminalServices LocalSessionManager EventLog (ID=21&22&24&25)"
"""Get RDP TerminalServices RemoteConnectionManager EventLog (ID=1149)"
"""HKEY_USERS"
"""HelpInfo"
"""Helper"
"""Info"
"""IpAddress"
"""IpAddress:"
"""KillEvenlogService"
"""KillEventlogService"
"""Launch"
"""LocalSessionManager"
"""LogParser.exe -stats:OFF -i:EVT \"
"""LogParser.exe"
"""MM"
"""MaxSize"
"""Name"
"""New Size: "
"""New status (0 open / 1 close): "
"""Old Size: "
"""Old status (0 open / 1 close): "
"""PowerShell Get-WinEvent cmdlet not work(.net Version < 3.5)."
"""PowerShellExecutionPolicy"
"""RDP-Tcp PortNumber: "
"""RDPLoginFail.csv"
"""RdpCoreTS"
"""RdpLogPath"
"""Reg Delete with powershell"
"""Reg Delete: $1 /f"
"""RegClientHostName"
"""RegName"
"""RegNamePS"
"""RegPath With PowerShell"
"""RegPath"
"""RegPath:"
"""RegRdcServer"
"""RegRdpPort"
"""RegSecMaxSize $EventLogType $MaxSize"
"""RegSecMaxSize"
"""RegValue"
"""RegValue:"
"""RegfDenyTSConnections $fDenyTSConnections"
"""Registry::$RegPathName"
"""Registry::HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default"
"""Registry::HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Servers\"
"""Registry::HKEY_CURRENT_USER\Volatile Environment\"
"""Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-TerminalServices-LocalSessionManager/Operational"
"""Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-TerminalServices-RemoteConnectionManager/Operational"
"""Registry::HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server"
"""Registry::HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\eventlog\Security"
"""Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\"
"""Registry::HKEY_USERS"
"""Registry::HKEY_USERS\"
"""RemoteConnectionManager"
"""SELECT EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP,COUNT(SourceIP) AS Times INTO RDPLoginFail.csv FROM Security WHERE EventID IN ('4625') AND SourceIP NOT IN ('-') GROUP BY SourceIP ORDER BY Times desc\"
"""SELECT TimeGenerated,EXTRACT_TOKEN(Strings, 5, '|') as Username, EXTRACT_TOKEN(Strings, 19, '|') AS SourceIP ,EXTRACT_TOKEN(Strings, 20, '|') AS Sport INTO RDPLoginFail.csv FROM Security WHERE EventID IN ('4625')\"
"""Search Done."
"""Search RDS from HKEY_USERS. Result: Regpath - Value"
"""Search"
"""SearchAll - ClientActiveXCore"
"""SearchAll - EventLogCredentials"
"""SearchAll - EventLogSuccess"
"""SearchAll - LocalSessionManager"
"""SearchAll - RdpCoreTS"
"""SearchAll - RdpPort"
"""SearchAll - RegClientHostName"
"""SearchAll - RegRdcServer"
"""SearchAll - RemoteConnectionManager"
"""SearchAll"
"""SearchAllEventLog"
"""Sec_.evtx"
"""Security"
"""Security.evtx"
"""Select EventLogType:"
"""Set-Itemproperty -path 'Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PowerShell\\1\\ShellIds\\Microsoft.PowerShell' -Name 'ExecutionPolicy' -value 'RemoteSigned'"
"""Set-Itemproperty -path 'Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PowerShell\\1\\ShellIds\\Microsoft.PowerShell' -Name 'ExecutionPolicy' -value 'Restricted'"
"""Set-Itemproperty -path 'Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PowerShell\\1\\ShellIds\\Microsoft.PowerShell' -Name 'ExecutionPolicy' -value 'Unrestricted'"
"""Setup"
"""Start Eventlog Service"
"""StartEventlogService"
"""Stop Eventlog Service to First Login RDP"
"""SubjectDomainName"
"""System"
"""SystemTime"
"""TargetUserName"
"""TempLog"
"""TimeCreate"
"""TimeCreated"
"""User"
"""Windows PowerShell\"
"""[+] CLIENTNAME: "
"""[+] ClientHostName: "
"""[+] RegPath: "
"""[+] Server: "
"""[+] Server:port > "
"""\$PSVersionTable.CLRVersion.Major"
"""\*"
"""\Sec_.evtx"
"""\Software\Microsoft\Terminal Server Client\Default\"
"""\Software\Microsoft\Terminal Server Client\Servers\"
"""\Volatile Environment\"
"""\documents\"
"""_.evtx"
"""close"
"""dir 'HKLM:\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP'"
"""fDenyTSConnections"
"""for /f %i in (\'wevtutil el\') do @(wevtutil cl \"
"""for /f \"
"""full address"
"""get-Executionpolicy"
"""if CheckNetVersion < 3.5, Please use 'wevtutil epl evtx' to xml."
"""mydocuments"
"""name = 'eventlog'"
"""net start eventlog"
"""open"
"""reg add \"
"""reg delete \"
"""tokens=1* delims=:\"
"""type RDPLoginFail.csv"
"""wevtutil cl \"
"""wevtutil epl Security ./Sec_.evtx /ow:true"
"""wmic nteventlog get path\,filename\,writeable"
