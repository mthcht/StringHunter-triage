"(""B"
"(""B<D"
"(""Calling DsrGetDcNameEx2 now..."""
"(""Failed to bind to NRPC interface!"""
"(""Failed to trigger the vulnerability!"""
"(""Sending DsrGetDcNameEx2 request..."""
"(""Server has been shut down."""
"(""Successfuly triggered the vulnerability!"""
"(""This might be because the target is doesn't have netlogon service running."""
"(""Waiting for udp server to start..."""
"(""lm_referral must be an even number"""
"(""lm_referral must be between 1 and 255"""
"(""q!"
"(""target_ip"", help=""Target IP address (required"
"('0.0.0.0', listen_port"
"(,]p"
"(3#,8y"
"(F#,C"
"(H6,"
"(HN""QCY"
"(QA@taR*""XI*"
"(_WR%""vm"
"(b""\x02\x01"""
"(elements, tag=self.tag"
"(f""Connected to {target_ip}:{port}"""
"(f""Connection refused: {exc}"""
"(f""Error received: {exc}"""
"(f""NetLogon connected"""
"(f""Received LDAP request from NetLogon {addr}"""
"(f""Sending malicious LDAP response packet to {addr}: {vulnerable_ldap_packet}"""
"(length=1, byteorder='big'"
"(message_id: int, lm_referral: int=2"
"(p?,Q ?."
"(resultCode=REFERRAL_RESULT_CODE, referral=['ldap://referral.com']"
"(self, data: bytes, addr"
"(self, exc"
"(self, transport: asyncio.DatagramTransport"
"(self.berdecoder, data"
"(target=start_ldap_server, daemon=True, args=(args.listen_port,"
"(target_ip: str, port: int, account: str, site_name: str, domain_name: str"
"(value=ldap_search_result, id=message_id"
"(vulnerable_ldap_packet, addr"
(	g
( 
(!
(#d
(#uRJA
(&
(&a5CH
(&r
('
('*VBk
('my_logger'
((
(((
((((
((55
().__init__(
(*J88
(-
(/
(0
(0&
(1! 
(1_
(2
(2@11
(3
(3/M\
(4
(4c\'D
(5
(5xq@Qazj
(6
(8
(8 
(9
(<
(<gX?
(=
(@
(@U0`
(@guhe120
(@t
(Au
(B36~
(BSMBi
(C
(D
(DJ
(E0K
(INCLUDING NEGLIGENCE OR OTHERWISE
(K
(KVB
(KY!t
(LDAP
(LDAP referral
(N
(NRPC
(NT2}
(Ne
(O
(P
(PK
(Q
(Q 2W
(Qm:w
(R
(SRV records map a domain to a port and another domain
(TS
(U	
(V(q
(W
(W_ 
(]0
(]5
(_4@Pvvx 
(`
(a
(asyncio.DatagramProtocol
(big-endian
(c
(c/
(console/file
(console_handler
(custom_format
(d
(d9&
(default: 389
(default: 49664
(default: Administrator
(default: empty string
(e%`0
(f'ncacn_ip_tcp:{target_ip}[{port}]'
(formatter
(g_
(gbU
(h
(https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-49113
(https://nvd.nist.gov/vuln/detail/CVE-2024-49113
(https://twitter.com/oryair1999
(https://www.linkedin.com/in/or-yair/
(https://www.linkedin.com/in/shahak-morag-6bb51b142/
(https://www.safebreach.com/blog/ldapnightmare-safebreach-labs-publishes-first-proof-of-concept-exploit-for-CVE-2024-49113/
(https://x.com/shahakmo
(ih2KUk
(k
(ldap_message.id
(levelname
(listen_port: int
(logging.INFO
(message
(mitZ>8
(nrpc.MSRPC_UUID_NRPC
(o
(ot
(published on January 1st 2025
(pureldap.LDAPBindResponse_serverSaslCreds(self.serverSaslCreds
(pureldap.LDAPSearchResultDone
(q
(r
(request
(run_exploit_server(listen_port
(s
(self
(self.errorMessage
(self.matchedDN
(self.resultCode
(t
(t2U
(u#C<5|
(until Ctrl-C or you close the loop
(url
(valid LDAP URL
(w
(y#T
(y[O#?
(z
({
(|1g9
(}
