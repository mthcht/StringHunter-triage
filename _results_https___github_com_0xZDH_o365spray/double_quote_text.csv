""" "
""" % "
""" % (user.split("
""" (Basic Auth blocked for this user.)"
""" (Manually confirm [MFA, Locked, etc.])"
""" * (15 - len("
""" -- v{__version__}"
""" Id="
""" alt="
""" encoding="
""" f"
""" for code in body["
""" if append else "
""" if key else "
""" if not args.password else args.password.split("
""" in body["
""" in response.headers["
""" locked accounts"
""" minutes"
""" passwords/spray"
""" seconds"
""" threads"
""" width="
""" xmlns:wsa="
""" xmlns:wsp="
""" xmlns:wsse="
""" xmlns:wst="
""" xmlns:wsu="
""""""
""""".join(random.choice("
"""%Y-%m-%d %H:%M:%S"
"""%Y-%m-%dT%H:%M:%S.001Z"
"""%s@%s"
"""%y%m%d%H%M"
"""&"
"""'%s'"
"""(-u/--username or -U/--userfile) and (-p/--password or -P/--passfile) -> "
"""({msg}.)"
""",           "
""",         "
""",        "
""",     "
""",    "
""",   "
""", "
""", action="
""", help="
""", type=str, help="
""","
"""--adfs-url"
"""--count"
"""--debug"
"""--domain"
"""--enum"
"""--enum-module"
"""--jitter"
"""--lockout"
"""--output"
"""--paired"
"""--passfile"
"""--password"
"""--poolsize"
"""--proxy"
"""--proxy-url"
"""--rate"
"""--safe"
"""--sleep"
"""--spray"
"""--spray-module"
"""--timeout"
"""--useragents"
"""--userfile"
"""--username"
"""--validate"
"""--validate-module"
"""--version"
"""-P"
"""-U"
"""-c"
"""-d"
"""-d/--domain is required."
"""-l"
"""-p"
"""-u"
"""-u/--username or -U/--userfile is required when performing user "
"""-v"
"""."
""".default"
""".join("
"""/"
"""1"
"""1.0"
"""14.0"
"""22098786-6e16-43cc-a27d-191a01a1e3b5"
"""26a7ee05-5602-4d76-a7ba-eae8b7b67941"
"""4e291c71-d680-4d0e-9640-0a3358e31177"
"""57336123-6e14-4acc-8dcf-287b6088aa28"
"""872cd9fa-d31f-45e0-9eab-6e460a02d1f1"
"""90%"
"""9ba1a5c7-f17a-4de9-a1f1-6178c8d51223"
""":  ["
""": "
""": ["
""": proxy, "
""":"
""">(AADSTS.+?)<"
""">I"
"""?"
"""?1"
"""@"
"""AADSTS500011"
"""AADSTS50034"
"""AADSTS50053"
"""AADSTS50055"
"""AADSTS50057"
"""AADSTS50059"
"""AADSTS50076"
"""AADSTS50079"
"""AADSTS50126"
"""AADSTS50128"
"""AADSTS50158"
"""AADSTS53003"
"""AADSTS700016"
"""AADSTS{code}"
"""ADFS AuthURL:\n{adfs}"
"""ADFS Sprayer module class"
"""AS IS"
"""Accept"
"""Accept-Encoding"
"""Accept-Language"
"""Access blocked via Conditional Access Policies"
"""Account locked"
"""Actions"
"""ActiveSync Sprayer module class"
"""AuthURL of the target domain's ADFS login page for password spraying."
"""AuthURL"
"""Autodiscover Enumeration module class"
"""Autodiscover Sprayer module class"
"""Autologon Enumeration module class"
"""Autologon Sprayer module class"
"""Basic Auth Blocked"
"""BasicAuthBlockStatus - Deny"
"""BlockBasicAuth - User blocked"
"""Close the file handle"
"""Color codes for colorized terminal output"
"""Connection"
"""Content-Type"
"""Credentials"
"""Custom class to write data to a file accross threads"
"""DISABLED"
"""DNT"
"""Debug"
"""Default: 10"
"""Default: current directory"
"""Desktop SSO disabled. Shutting down..."
"""DesktopSsoEnabled"
"""Disabling user enumeration against Federated Realm."
"""ERROR: Invalid module\n{e}"
"""EXPIRED_PASS"
"""Enable debug output."
"""End of password spraying user list reached."
"""EnumerateModule_{args.enum_module}"
"""EstsProperties"
"""Federated Realm [Y/n] "
"""Federated"
"""File containing list of credentials in username:password format."
"""File containing list of passwords."
"""File containing list of user agents for randomization."
"""File containing list of usernames."
"""FireProx API URL."
"""Flush the file buffer"
"""GetUserRealm Validation module class"
"""Global default values"
"""Global output file name defaults"
"""HTTP Configuration"
"""HTTP request timeout in seconds. Default: 25"
"""HTTP/S proxy to pass traffic through (e.g. http://127.0.0.1:8080)."
"""Helper functions"
"""INVALID_APPID"
"""INVALID_CREDS"
"""INVALID_DOMAIN"
"""INVALID_RESOURCE"
"""IfExistsResult"
"""Initialize the parent base class"
"""Invalid HTTP request method: {method}"
"""Invalid application client ID"
"""Invalid domain for password spraying: '{domain}'"
"""Invalid domain for user enumeration: '{domain}'"
"""Invalid domain to validate: '{domain}'"
"""Invalid output directory: {out_dir}"
"""Invalid resource name"
"""Invalid username or password"
"""Jitter extends --sleep period by percentage given (0-100). Default: 0"
"""LOCKED"
"""Locked account limit reached."
"""Locked account threshold reached. Exiting..."
"""Lockout policy's reset time (in minutes). Default: 15 minutes"
"""MBI"
"""MISSING_TENANT"
"""MS-ASProtocolVersion"
"""Main entry point for o365spray"
"""Managed"
"""Maximum size of the ThreadPoolExecutor. Default: 10000"
"""Microsoft Office/16.0 (Windows NT 10.0; Microsoft Outlook 16.0.12026; Pro)"
"""Missing 1 required argument: 'output_dir'"
"""Module Base"
"""Module Configuration"
"""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36"
"""Must override _enumerate"
"""Must override _spray"
"""Must override _validate"
"""NameSpaceType"
"""No user list provided for spraying."
"""No users provided to run a password spray against."
"""Number of concurrent connections (attempts) during enumeration and "
"""Number of password attempts to run per user before resetting the "
"""Office Enumeration module class"
"""OneDrive Enumeration module class"
"""Output Configuration"
"""Output directory for results and test case files. "
"""PPAuthInfo"
"""Parent implementation of module child method"
"""Password Spraying Configuration"
"""Password expired"
"""Password spraying the following passwords: [%s]"
"""Password spraying using paired usernames:passwords."
"""Password spraying {len(userlist)} paired accounts."
"""Password(s) delimited using commas."
"""Password1"
"""Perform user enumeration against Microsoft O365."
"""Print the tool version."
"""Provided user list is not a list -> provided: {type(self.userlist)}"
"""RST Sprayer module class"
"""RST0"
"""Reporting Sprayer module class"
"""Requests are being throttled. Shutting down..."
"""Resetting lockout before password spraying."
"""Response indicates MFA (Microsoft) must be onboarded"
"""Response indicates MFA (Microsoft)"
"""Response indicates conditional access (MFA: DUO or other)"
"""Root=1"
"""Run domain validation only."
"""Run password spraying."
"""Run username enumeration."
"""Running password spray against %d users."
"""Running user enumeration against {len(userlist)} potential users"
"""SEC_CHAL"
"""Scan Configuration"
"""Sec-Fetch-Dest"
"""Sec-Fetch-Mode"
"""Sec-Fetch-Site"
"""Sec-Fetch-User"
"""Sleeping for %.1f minutes"
"""Sleeping for {throttle} seconds before sending request."
"""Software"
"""Specify which enumeration module to run. Default: office"
"""Specify which password spraying module to run. Default: oauth2"
"""Specify which valiadtion module to run. Default: getuserrealm"
"""SprayModule_{args.spray_module}"
"""Switching to ADFS module for password spraying"
"""Switching to oAuth2 module for user enumeration"
"""Target domain for validation, user enumeration, "
"""Target"
"""Tenant for account doesn't exist"
"""Tenant not provisioned for this type of authentication. Shutting down..."
"""TenantNotProvisioned"
"""Terminate password spraying run if `N` locked accounts are observed. "
"""The following domain appears to be using O365, but is Federated: {args.domain}"
"""The following domain appears to be using O365: {args.domain}"
"""The following domain does not appear to be using O365: {args.domain}"
"""Throttle HTTP requests every `N` seconds. This can be randomized by "
"""ThrottleStatus"
"""USER_NOT_FOUND"
"""UTF-8"
"""Upgrade-Insecure-Requests"
"""User disabled"
"""User does not exist"
"""User enumeration using authentication was run. "
"""User-Agent"
"""UserName={quote(email)}&Password={quote(password)}&AuthMethod=FormsAuthentication"
"""Username(s) delimited using commas."
"""VALID_CAP"
"""VALID_MFA"
"""Valid Accounts: %d"
"""Valid Credentials: %d"
"""ValidateModule_{args.validate_module}"
"""Validating: {args.domain}"
"""Vary"
"""When running password spraying via --spray, the following flags are required: "
"""X-AutoDiscovery-Error"
"""X-Forwarded-Port"
"""X-Forwarded-Proto"
"""X-My-X-Amzn-Trace-Id"
"""X-My-X-Forwarded-For"
"""Y"
"""[ ? ]\tSwitch to the ADFS module for password spraying [Y/n] "
"""[ ? ]\tSwitch to the oAuth2 module for user enumeration against a "
"""[%(asctime)s] %(levelname)-5s | %(filename)17s:%(lineno)-4s | %(message)s"
"""[%(asctime)s] %(levelname)-5s | %(message)s"
"""[-1, 0-120]"
"""[0-100]"
"""[{text_colors.FAIL}BLOCKED{text_colors.ENDC}] {email}:{password}"
"""[{text_colors.FAIL}FAILED{text_colors.ENDC}] "
"""[{text_colors.FAIL}INVALID{text_colors.ENDC}] "
"""[{text_colors.FAIL}{err}{text_colors.ENDC}] "
"""[{text_colors.OKGREEN}VALID{text_colors.ENDC}] "
"""[{text_colors.OKGREEN}VALID{text_colors.ENDC}] {email}"
"""[{text_colors.OKGREEN}VALID{text_colors.ENDC}] {email}:{password} {text_colors.OKGREEN}({msg}.){text_colors.ENDC}"
"""[{text_colors.OKGREEN}VALID{text_colors.ENDC}] {email}:{password}"
"""[{text_colors.OKGREEN}VALID{text_colors.ENDC}] {user}"
"""[{text_colors.WARNING}DIFFIDP{text_colors.ENDC}] {email}"
"""[{text_colors.WARNING}WARNING{text_colors.ENDC}] "
"""\n            *** O365 Spray ***            \n"
"""\n   > %s%s:  %s"
"""\n   > start%s:  %s"
"""\n   > version%s:  %s"
"""\n"
"""\n>----------------------------------------<\n"
"""\n[ * ] Accounts in different Identity Providers can be found at: '{self.idp_writer.output_file}'"
"""\n[ * ] All enumerated accounts can be found at: '{self.tested_writer.output_file}'\n"
"""\n[ * ] All sprayed credentials can be found at: '{self.tested_writer.output_file}'\n"
"""\n[ * ] Valid accounts can be found at: '{self.valid_writer.output_file}'"
"""\n[ * ] Writing valid credentials to: '{self.valid_writer.output_file}'"
"""\n\n"
"""\n\n[ ! ] CTRL-C caught."
"""\r"
"""\r[*] Next spray in: {timedelta(seconds=remaining - 1)}"
"""\r\n"
"""\x1b[2K"
"""] = "
"""].split("
"""]["
"""^https?://"
"""_"
"""_0"
"""__main__"
"""a"
"""a40d7d7d-59aa-447e-a655-679a4107e548"
"""ab9b8c07-8f02-4f72-87fa-80105867a763"
"""abcdef0123456789"
"""activesync"
"""adfs"
"""and/or password spraying."
"""application/json"
"""application/soap+xml"
"""application/x-www-form-urlencoded"
"""c0d2a505-13b8-4ae0-aa9e-cddd5eab0b12"
"""center"
"""checkPhones"
"""client_id"
"""count"
"""crit"
"""debg"
"""delete"
"""document"
"""e9c51622-460d-4d3d-952d-966a5b1da34c"
"""eb539595-3fe1-474e-9c1d-feb3625d1be5"
"""ecd6b820-32c2-49b6-98a6-444530e5a77a"
"""en-US,en;q=0.5"
"""enum_found_idp_accounts.{F_TIME}.txt"
"""enum_module"
"""enum_tested_accounts.{F_TIME}.txt"
"""enum_valid_accounts.{F_TIME}.txt"
"""enumeration via --enum."
"""error_codes"
"""error_description"
"""f44b1140-bc5e-48c6-8dc0-5cf5a53c0e34"
"""fail"
"""get"
"""getuserrealm"
"""grant_type"
"""graph.microsoft.com"
"""graph.windows.net"
"""gzip, deflate"
"""head"
"""http"
"""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"
"""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"
"""http://schemas.microsoft.com/LiveID/SoapServices/v1"
"""http://schemas.xmlsoap.org/ws/2004/09/policy"
"""http://schemas.xmlsoap.org/ws/2005/02/trust"
"""http://www.w3.org/2003/05/soap-envelope"
"""http://www.w3.org/2005/08/addressing"
"""https"
"""https://autodiscover-s.outlook.com/autodiscover/autodiscover.xml"
"""https://autologon.microsoftazuread-sso.com/{domain}/winauth/trust/2005/usernamemixed?client-request-id={uuid4()}"
"""https://login.microsoftonline.com/common/GetCredentialType?mkt=en-US"
"""https://login.microsoftonline.com/common/oauth2/token"
"""https://login.microsoftonline.com/getuserrealm.srf?login=user@{domain}&xml=1"
"""https://login.microsoftonline.com/rst2.srf"
"""https://outlook.office365.com/Microsoft-Server-ActiveSync"
"""https://outlook.office365.com/autodiscover/autodiscover.json/v1.0/{email}?Protocol=Autodiscoverv1"
"""https://reports.office365.com/ecp/reportingwebservice/reporting.svc"
"""https://{tenant}-my.sharepoint.com/personal/{fmt_user}_{domain}/_layouts/15/onedrive.aspx"
"""info"
"""invalid password file provided"
"""invalid user agent file provided"
"""invalid username file provided"
"""isCookieBannerShown"
"""isFidoSupported"
"""isOtherIdpSupported"
"""isRemoteNGCSupported"
"""keep-alive"
"""lockout account timer. Default: 1"
"""lockout"
"""n"
"""navigate"
"""none"
"""o365spray -- {__version__}"
"""o365spray executed in {elapsed:.2f} seconds."
"""o365spray | Microsoft O365 User Enumerator and Password Sprayer"
"""o365spray"
"""o365spray.core.handlers.enumerator.modules.{args.enum_module}"
"""o365spray.core.handlers.sprayer.modules.{args.spray_module}"
"""o365spray.core.handlers.validator.modules.{args.validate_module}"
"""oAuth2 Enumeration module class"
"""oAuth2 Sprayer module class"
"""oauth2"
"""offline_access"
"""openid"
"""options"
"""otherwise, --paired is required."
"""passing the value `-1` (between 1 sec and 2 mins). Default: 0"
"""password"
"""patch"
"""post"
"""profile"
"""psf:text"
"""put"
"""r"
"""random ({len(_args[arg])})"
"""rate"
"""raw.log"
"""resource"
"""safe"
"""scope"
"""spray_module"
"""spray_tested_credentials.{F_TIME}.txt"
"""spray_valid_credentials.{F_TIME}.txt"
"""spraying. Default: 10"
"""start"
"""static/o365spray_validate.png"
"""store_true"
"""text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"
"""timeout"
"""user"
"""useragents"
"""username"
"""username="
"""username={email}"
"""uuid-{uuid4()}"
"""version"
"""w"
"""warn"
"""win32"
"""wsse:BinarySecurityToken"
"""x-amzn-apigateway-api-id"
"""xml"
"""y"
"""{_V_MAJ}.{_V_MIN}.{_V_MNT}"
"""{account}\n"
"""{bcolors.FAIL}%s{bcolors.ENDC}"
"""{bcolors.OKBLUE}%s{bcolors.ENDC}"
"""{bcolors.WARNING}%s{bcolors.ENDC}"
"""{b}-{f}-{s}"
"""{data}\n"
"""{email} -> Different Identity Provider"
"""{email}:{password} "
"""{email}:{password}"
"""{email}:{password}{' '*10}"
"""{email}{' '*10}"
"""{k}:{v}"
"""{orig_user} -> {user}"
"""{out_dir}{file_}"
"""{output_dir}/enum/"
"""{output_dir}/spray/"
"""{proxy_url}/Microsoft-Server-ActiveSync"
"""{proxy_url}/autodiscover/autodiscover.json/v1.0/{email}?Protocol=Autodiscoverv1"
"""{proxy_url}/autodiscover/autodiscover.xml"
"""{proxy_url}/common/GetCredentialType?mkt=en-US"
"""{proxy_url}/common/oauth2/token"
"""{proxy_url}/ecp/reportingwebservice/reporting.svc"
"""{proxy_url}/personal/{fmt_user}_{domain}/_layouts/15/onedrive.aspx"
"""{proxy_url}/rst2.srf"
"""{proxy_url}/{domain}/winauth/trust/2005/usernamemixed?client-request-id={uuid4()}"
"""{self.output_dir}{email}.token.json"
"""{url}?{url_params}"
"""{user} -> {email}"
"""{user}{' '*10}"
