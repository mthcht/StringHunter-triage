"[""@odata.context"""
"[""Add-ApplicationCertificate"", ""Add client certificate to target application"""
"[""Add-ApplicationPassword"", ""Add client secret to target application"""
"[""Add-ApplicationPermission"", ""Add permission to target application e.g. Mail.Send and attempt to grant admin consent"""
"[""Add-ExclusionGroupToPolicy"", ""Bypass av, asr, etc. rules by adding an exclusion group containing compromised user or device"""
"[""Add-GroupMember"", ""Add member to target group"""
"[""Add-UserTAP"", ""Add new Temporary Access Password (TAP) to target user"""
"[""Assign-PrivilegedRole"", ""Assign chosen privileged role to user/group/object"""
"[""Autologon"", ""RST2"""
"[""Backdoor-Script"", ""Add malicious code to pre-existing device management script"""
"[""Create-Application"", ""Create new enterprise application with default settings"""
"[""Create-NewUser"", ""Create new Entra ID user"""
"[""Decode-AccessToken"", ""Get all token payload attributes"""
"[""Delete-Application"", ""Delete an application"""
"[""Delete-Device"", ""Delete managed device"""
"[""Delete-Group"", ""Delete a group"""
"[""Delete-User"", ""Delete a user"""
"[""Deploy-MaliciousScript"", ""Deploy new malicious device management PowerShell script"""
"[""Deploy-MaliciousWebLink"", ""Deploy malicious Windows web link application"""
"[""Description"""
"[""Display-ASRPolicyRules"", ""Display Attack Surface Reduction (ASR) policy rules"""
"[""Display-AVPolicyRules"", ""Display antivirus policy rules"""
"[""Display-DiskEncryptionPolicyRules"", ""Display disk encryption policy rules"""
"[""Display-EDRPolicyRules"", ""Display EDR policy rules"""
"[""Display-FirewallConfigPolicyRules"", ""Display firewall configuration policy rules"""
"[""Display-FirewallRulePolicyRules"", ""Display firewall RULE policy rules"""
"[""Display-LAPSAccountProtectionPolicyRules"", ""Display LAPS account protection policy rules"""
"[""Display-UserGroupAccountProtectionPolicyRules"", ""Display user group account protection policy rules"""
"[""Dump-AndroidApps"", ""Dump managed Android mobile applications"""
"[""Dump-DeviceManagementScripts"", ""Dump device management PowerShell scripts"""
"[""Dump-OWAMailbox"", ""Dump OWA Office 365 mailbox"""
"[""Dump-WindowsApps"", ""Dump managed Windows OS applications (exe, msi, appx, msix, etc.)"""
"[""Dump-iOSApps"", ""Dump managed iOS/iPadOS mobile applications"""
"[""Dump-macOSApps"", ""Dump managed macOS applications"""
"[""Find-DynamicGroups"", ""Find groups with dynamic membership rules"""
"[""Find-PrivilegedApplications"", ""Find privileged apps (via their service principal) with granted admin consent API permissions"""
"[""Find-PrivilegedRoleUsers"", ""Find users with privileged roles assigned"""
"[""Find-SecurityGroups"", ""Find security groups and group members"""
"[""Find-UpdatableGroups"", ""Find groups which can be updated by the current user"""
"[""Get-AdministrativeUnitMember"", ""Get members of administrative unit"""
"[""Get-AppServicePrincipal"", ""Get details of the application's service principal from the app ID (--id)"""
"[""Get-Application"", ""Get Enterprise Application details for app (NOT object) ID (--id)"""
"[""Get-CAPs"", ""Get conditional access policies"""
"[""Get-ConditionalAccessPolicy"", ""Get conditional access policy properties"""
"[""Get-CrossTenantAccessPolicy"", ""Get cross tenant access policy properties"""
"[""Get-CurrentUser"", ""Get current user profile"""
"[""Get-CurrentUserActivities"", ""Get recent activity and actions of current user"""
"[""Get-DeviceCategories"", ""Get device categories"""
"[""Get-DeviceCompliancePolicies"", ""Get all device compliance policies (Android, iOS, macOS, Windows, Linux, etc.)"""
"[""Get-DeviceComplianceSummary"", ""Get device compliance summary"""
"[""Get-DeviceConfigurationPolicies"", ""Get device configuration policies and assignment details (AV, ASR, DiskEnc, etc.)"""
"[""Get-DeviceConfigurationPolicySettings"", ""Get device configuration policy settings"""
"[""Get-DeviceConfigurations"", ""Get device configurations"""
"[""Get-DeviceEnrollmentConfigurations"", ""Get device enrollment configurations"""
"[""Get-DeviceGroupPolicyConfigurations"", ""Get device group policy configurations and assignment details"""
"[""Get-DeviceGroupPolicyDefinition"", ""Get device group policy definition"""
"[""Get-Domains"", ""Get domain objects"""
"[""Get-GraphTokens"", ""Obtain graph token via device code phish (saved to graph_tokens.txt)"""
"[""Get-Group"", ""Get all groups (default) or target group (-id)"""
"[""Get-GroupMember"", ""Get all members of target group"""
"[""Get-ManagedDevices"", ""Get managed devices"""
"[""Get-Messages"", ""Get all messages in signed-in user's mailbox (default) or target user (--id)"""
"[""Get-OneDriveFiles"", ""Get all accessible OneDrive files for current user (default) or target user (--id)"""
"[""Get-OrgInfo"", ""Get information relating to the target organisation"""
"[""Get-PartnerCrossTenantAccessPolicy"", ""Get partner cross tenant access policy"""
"[""Get-Password"", ""Get passwords registered to current user (default) or target user (--id)"""
"[""Get-PersonalContacts"", ""Get contacts of the current user"""
"[""Get-RoleAssignments"", ""Get role assignments"""
"[""Get-RoleDefinitions"", ""Get role definitions"""
"[""Get-ScriptContent"", ""Get device management script content"""
"[""Get-ServicePrincipal"", ""Get all or specific Service Principal details (--id)"""
"[""Get-ServicePrincipalAppRoleAssignments"", ""Get Service Principal app role assignments (shows available admin consent permissions that are already granted)"""
"[""Get-TemporaryAccessPassword"", ""Get TAP details for current user (default) or target user (--id)"""
"[""Get-TenantID"", ""Get tenant ID for target domain"""
"[""Get-TokenScope"", ""Get scope of supplied token"""
"[""Get-User"", ""Get all users (default) or target user (--id)"""
"[""Get-UserAppRoleAssignments"", ""Get user app role assignments for current user (default) or target user (--id)"""
"[""Get-UserChatMessages"", ""Get ALL messages from all chats for target user (Chat.Read.All)"""
"[""Get-UserDevices"", ""Get user devices"""
"[""Get-UserPermissionGrants"", ""Get permission grants of current user (default) or target user (--id)"""
"[""Get-UserPrivileges"", ""Get group/AU memberships and directory roles assigned for current user (default) or target user (--id)"""
"[""Get-UserProperties"", ""Get current user properties (default) or target user (--id)"""
"[""Get-UserTransitiveGroupMembership"", ""Get transitive group memberships for current user (default) or target user (--id)"""
"[""Get-oauth2PermissionGrants"", ""Get oauth2 permission grants for current user (default) or target user (--id)"""
"[""Grant-AppAdminConsent"", ""Grant admin consent for Graph API permission already assigned to enterprise application"""
"[""Invite-GuestUser"", ""Invite guest user to Entra ID"""
"[""Invoke-AppSecretToAccessToken"", ""Convert Azure Application secretText credentials to access token (saved to appsecret_tokens.txt)"""
"[""Invoke-CertToAccessToken"", ""Convert Azure Application certificate to JWT access token (saved to cert_tokens.txt)"""
"[""Invoke-CustomQuery"", ""Custom GET query to target Graph API endpoint"""
"[""Invoke-ESTSCookieToAccessToken"", ""Convert ESTS cookie to MS Graph access token (saved to estscookie_tokens.txt)"""
"[""Invoke-ReconAsOutsider"", ""Perform outsider recon of the target domain"""
"[""Invoke-RefreshToAzureManagementToken"", ""Convert refresh token to Azure Management token (saved to az_tokens.txt)"""
"[""Invoke-RefreshToIntuneEnrollmentToken"", ""Convert refresh token to Intune Enrollment token (saved to intune_tokens.txt)"""
"[""Invoke-RefreshToMSGraphToken"", ""Convert refresh token to Microsoft Graph token (saved to new_graph_tokens.txt)"""
"[""Invoke-RefreshToMSTeamsToken"", ""Convert refresh token to MS Teams token (saved to teams_tokens.txt)"""
"[""Invoke-RefreshToOfficeAppsToken"", ""Convert refresh token to Office Apps token (saved to officeapps_tokens.txt)"""
"[""Invoke-RefreshToOfficeManagementToken"", ""Convert refresh token to Office Management token (saved to officemanagement_tokens.txt)"""
"[""Invoke-RefreshToOneDriveToken"", ""Convert refresh token to OneDrive token (saved to onedrive_tokens.txt)"""
"[""Invoke-RefreshToOutlookToken"", ""Convert refresh token to Outlook token (saved to outlook_tokens.txt)"""
"[""Invoke-RefreshToSharePointToken"", ""Convert refresh token to SharePoint token (saved to sharepoint_tokens.txt)"""
"[""Invoke-RefreshToSubstrateToken"", ""Convert refresh token to Substrate token (saved to substrate_tokens.txt)"""
"[""Invoke-RefreshToVaultToken"", ""Convert refresh token to Azure Vault token (saved to vault_tokens.txt)"""
"[""Invoke-RefreshToYammerToken"", ""Convert refresh token to Yammer token (saved to yammer_tokens.txt)"""
"[""Invoke-Search"", ""Search for string within entity type (driveItem, message, chatMessage, site, event)"""
"[""Invoke-UserEnumerationAsOutsider"", ""Checks whether the user exists within Azure AD"""
"[""List-AdministrativeUnits"", ""List administrative units"""
"[""List-Applications"", ""List all Azure Applications"""
"[""List-AuthMethods"", ""List authentication methods for current user (default) or target user (--id)"""
"[""List-ChatMessages"", ""List messages in target chat (--id)"""
"[""List-Chats"", ""List chats for current user (default) or target user (--id)"""
"[""List-ConditionalAccessPolicies"", ""List conditional access policy objects"""
"[""List-ConditionalAuthenticationContexts"", ""List conditional access authentication context"""
"[""List-ConditionalNamedLocations"", ""List conditional access named locations"""
"[""List-Devices"", ""List devices"""
"[""List-DirectoryRoles"", ""List all directory roles activated in the tenant"""
"[""List-ExternalConnections"", ""List external connections"""
"[""List-JoinedTeams"", ""List joined teams for current user (default) or target user (--id)"""
"[""List-Notebooks"", ""List current user notebooks (default) or target user (--id)"""
"[""List-OneDriveURLs"", ""List OneDrive web URLs visible to current user"""
"[""List-OneDrives"", ""List current user OneDrive (default) or target user (--id)"""
"[""List-RecentOneDriveFiles"", ""List current user recent OneDrive files"""
"[""List-ServicePrincipals"", ""List all service principals"""
"[""List-SharePointRoot"", ""List root SharePoint site properties"""
"[""List-SharePointSites"", ""List any available SharePoint sites"""
"[""List-SharePointURLs"", ""List SharePoint site web URLs visible to current user"""
"[""List-SharedOneDriveFiles"", ""List OneDrive files shared with the current user"""
"[""List-Tenants"", ""List tenants"""
"[""Locate-DirectoryRole"", ""Locate Entra directory role information for template ID or role name"""
"[""Locate-ObjectID"", ""Locate object ID and display object properties"""
"[""Locate-PermissionID"", ""Locate Graph permission details (application/delegated, description, admin consent required) for ID or permission name"""
"[""Lock-Device"", ""Lock managed device"""
"[""New-SignedJWT"", ""Construct JWT and sign using Key Vault PEM certificate (Azure Key Vault access token required) then generate Azure Management token"""
"[""Open-OWAMailboxInBrowser"", ""Open an OWA Office 365 mailbox in BurpSuite's embedded Chromium browser using either a Substrate.Office.com or Outlook.Office.com access token"""
"[""Reboot-Device"", ""Reboot managed device"""
"[""Remove-GroupMember"", ""Remove user from a group"""
"[""Retire-Device"", ""Retire managed device"""
"[""Shutdown-Device"", ""Shutdown managed device"""
"[""Spoof-OWAEmailMessage"", ""Send email from current user's Outlook mailbox or spoof another user (--id) (Mail.Send)"""
"[""Update-DeviceConfig"", ""Update properties of the managed device configuration"""
"[""Update-UserPassword"", ""Update the passwordProfile of the target user (NewUserS3cret@Pass!)"""
"[""Update-UserProperties"", ""Update the user properties of the target user"""
"[""Wipe-Device"", ""Wipe managed device"""
"[""authorization_endpoint"""
"[""claims"""
"[""cp1"""
"[""description"""
"[""device_code"""
"[""drive"""
"[""driveItem"""
"[""invoke-reconasoutsider"", ""invoke-userenumerationasoutsider"""
"[""isAccessPassSupported"""
"[""locate-objectid"", ""locate-permissionid"", ""locate-directoryrole"""
"[""message"""
"[""roleTemplateId"""
"[""selector1"", ""selector2"""
"[""value"""
"['-' * 20, '-' * 20, '-' * 20"
"['-' * 20, '-' * 50"
"['Allitems', 'inbox', 'archive', 'drafts', 'sentitems', 'deleteditems', 'recoverableitemsdeletions'"
"['Android', 'IE', 'Chrome', 'Firefox', 'Edge', 'Safari'"
"['Mac', 'Windows', 'AndroidMobile', 'iPhone'"
"['assignments', 'scheduledActionsForRule'"
"['commands/graphpermissions.txt', 'commands/directoryroles.txt'"
"['driveItem', 'message', 'chatMessage', 'site', 'event'"
"['id', 'displayName', 'description', 'isAssignableToRole', 'onPremisesSyncEnabled', 'mail', 'createdDateTime', 'visibility'"
"['true', 'false'"
"['user', 'system'"
"['utf-8', 'utf-16', 'ascii', 'iso-8859-1'"
"[0, 6"
"[[""Display Name"", ""Role Template ID"", ""Description"""
"[[""Property"", ""Description"""
"[[prop[""Property"""
"[[role[""displayName"""
"[],""description"":""IntuneMessageBox"",""developer"":"""",""displayName"":""IntuneMessageBox"",""displayVersion"":"""",""fileName"":""IntuneMessageBox.intunewin"",""installCommandLine"":""IntuneMessageBox.exe"",""installExperience"":{""deviceRestartBehavior"":""suppress"",""maxRunTimeInMinutes"":30,""runAsAccount"":""system""},""informationUrl"":"""",""isFeatured"":false,""roleScopeTagIds"":["
"[elem.text for elem in tree.findall('.//ns2:Domain', namespaces)"
"[simple_setting_value.get('value', '') for simple_setting_value in simple_setting_values if simple_setting_value.get('value')"
"[{""@odata.type"":""#microsoft.graph.win32LobAppFileSystemRule"",""ruleType"":""detection"",""operator"":""notConfigured"",""check32BitOn64System"":false,""operationType"":""exists"",""comparisonValue"":null,""fileOrFolderName"":""IntuneMessageBox.exe"",""path"":""C:\\Program Files\\IntuneMessageBox.exe""}"
"[{""emailAddress"": {""address"": email.strip()}} for email in ccrecipients.split(',') if email.strip()"
"[{""emailAddress"": {""address"": email.strip()}} for email in torecipients.split(',') if email.strip()"
"[{""returnCode"":0,""type"":""success""},{""returnCode"":1707,""type"":""success""},{""returnCode"":3010,""type"":""softReboot""},{""returnCode"":1641,""type"":""hardReboot""},{""returnCode"":1618,""type"":""retry""}"
[ 
['@odata.type'
['Application'
['DKIM'
['DMARC'
['DNS'
['Delegated'
['GroupId'
['GroupName'
['Identifier'
['Location'
['MTA-STS'
['MX'
['Members'
['Name'
['SPF'
['STS'
['Type'
['accessDecision'
['appDisplayName'
['assignments'
['choiceSettingCollectionValue'
['choiceSettingValue'
['code'
['description'
['displayName'
['groupSettingCollectionValue'
['id'
['intent'
['name'
['options'
['resourceAccess'
['resourceAppId'
['roleTemplateId'
['scriptContent'
['settingDefinitionId'
['settingInstance'
['simpleSettingCollectionValue'
['simpleSettingValue'
['target'
['templateDisplayName'
['templateReference'
['template_id'
['type'
['value'
['values'
[*
[+
[-
[--id <userid to spoof>
[--id <userid>
[-1
[0
[1
[1:
[2
[3
[34m[>
[4
[92m{'Yes' if role['privileged'
[92m{role['description'
[92m{role['name'
[92m{role['template_id'
[:-1
[AADInternals
[Add-ApplicationCertificate
[Add-ApplicationPermission
[Add-ExclusionGroupToPolicy
[Assign-PrivilegedRole
[Authentication
[Azure AD available roles
[Backdoor-Script
[Cleanup
[Commands
[Demos
[Deploy-MaliciousScript
[Deploy-MaliciousWebLink
[Display-AVPolicyRules
[Find-DynamicGroups
[Find-PrivilegedApplications
[Find-PrivilegedRoleUsers
[Find-UpdatableGroups
[Get-Application
[Get-CurrentUser
[Get-DeviceCompliancePolicies
[Get-DeviceConfigurationPolicies
[Get-Domains
[Get-GraphTokens
[Get-Group
[Get-ManagedDevices
[Get-ScriptContent
[Get-TenantID
[Get-User
[Get-UserDevices
[Get-UserPrivileges
[GraphRunner
[Installation
[Invite-GuestUser
[Invoke-CertToAccessToken
[Invoke-ESTSCookieToAccessToken
[Invoke-ReconAsOutsider
[Invoke-RefreshToAzureManagementToken
[Invoke-RefreshToMSGraphToken
[Invoke-Search
[Invoke-UserEnumerationAsOutsider
[List-RecentOneDriveFiles
[Locate-DirectoryRole
[Locate-ObjectID
[Locate-PermissionID
[Locators
[Outsider
[Post-Auth Enumeration
[Post-Auth Exploitation
[Post-Auth Intune Enumeration
[Post-Auth Intune Exploitation
[Remove-GroupMember
[Spoof-OWAEmailMessage
[TokenTactics
[TokenTacticsV2
[Usage
[Version 1511
[Wiki
[])
[app['appId'
[app_role_id
[application_id
[args.entity
[args.username
[category
[child_def_id
[cleaned_value
[delegated_id
[domain
[here
[https://graphpermissions.merill.net/
[https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/permissions-reference
[https://learn.microsoft.com/en-us/graph/permissions-reference
[iface['value'
[len(setting_id):
[line.strip() for line in file if line.strip()
[name for name in permission_names if name not in content
[name.strip() for name in permission_names
[part
[permission_name
[permissionid
[port['value'
[role_id
[separator
[setting_def_id
[setting_id
[sp['id'
[th.text for th in table.find('thead').find_all('th')
[title
[value
[value_suffix
[x
[x.strip() for x in f.readlines()
[{}
